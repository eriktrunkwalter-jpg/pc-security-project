# CheckIdentityLeak.ps1
# Demonstrates why "System Proxy" is NOT enough for high-risk anonymity.
# Checks for static hardware/software identifiers that bypass the IP tunnel.

$ErrorActionPreference = "SilentlyContinue"
Write-Host ">>> ANALYZING FINGERPRINT TRACEABILITY <<<" -ForegroundColor Cyan

# 1. SCREEN RESOLUTION & COLOR DEPTH
# Websites query this via Javascript (window.screen.width/height)
$res = Get-CimInstance -ClassName Win32_VideoController
Write-Host "`n[LEAK 1] Screen Resolution (Fingerprint)" -ForegroundColor Yellow
Write-Host "Detected: $($res.CurrentHorizontalResolution) x $($res.CurrentVerticalResolution) ($($res.CurrentBitsPerPixel) bit)" -ForegroundColor Red
Write-Host "Analysis: Highly specific. Tor Browser forces a standard window size (e.g., 1000x800) to hide this."
Write-Host "          Your setup sends the REAL resolution."

# 2. TIMEZONE
# Websites query this via JS (new Date().getTimezoneOffset())
$tz = Get-TimeZone
Write-Host "`n[LEAK 2] System Timezone" -ForegroundColor Yellow
Write-Host "Detected: $($tz.Id) (Offset: $($tz.BaseUtcOffset))" -ForegroundColor Red
Write-Host "Analysis: Reveals your rough geographic location even if IP is in Timbuktu."
Write-Host "          Tor Browser forces UTC time. Your setup sends GERMAN time."

# 3. INSTALLED FONTS (The Silent Killer)
# Websites measure bounding boxes of text to list installed fonts.
$fonts = Get-ChildItem "C:\Windows\Fonts" | Measure-Object
Write-Host "`n[LEAK 3] Installed Fonts" -ForegroundColor Yellow
Write-Host "Detected: $($fonts.Count) fonts installed." -ForegroundColor Red
Write-Host "Analysis: The exact list of fonts creates a unique 'Hash'. If you installed ANY custom font (for games/design),"
Write-Host "          you are statistically UNIQUE among millions of users."

# 4. LANGUAGE
$lang = Get-Culture
Write-Host "`n[LEAK 4] Language Settings" -ForegroundColor Yellow
Write-Host "Detected: $($lang.Name) ($($lang.DisplayName))" -ForegroundColor Red
Write-Host "Analysis: Your browser sends 'Accept-Language: de-DE'. Most Tor users send 'en-US'."
Write-Host "          This flags you as a German user immediately."

# 5. CANVAS FINGERPRINT (Simulation)
Write-Host "`n[LEAK 5] GPU Renderer (Canvas Fingerprint)" -ForegroundColor Yellow
$gpu = Get-CimInstance -ClassName Win32_VideoController
Write-Host "GPU: $($gpu.Name)" -ForegroundColor Red
Write-Host "Analysis: Your specific GPU renders graphics slightly differently than others."
Write-Host "          This creates a unique 'Canvas Hash' that persists across cookies/IP changes."

Write-Host "`n---------------------------------------------------" -ForegroundColor White
Write-Host "CONCLUSION: YES, YOU ARE TRACEABLE." -ForegroundColor Red
Write-Host "1. You are using a UNIQUE browser configuration (Fingerprint)."
Write-Host "2. If you visited the site before (without Tor), they match the Fingerprint."
Write-Host "3. If you visit again later (without Tor), they match the Fingerprint."
Write-Host "---------------------------------------------------"
Read-Host "Press Enter to exit..."
